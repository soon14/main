<script>
function changeworkage(json){
	setTimeout(function(){
		var begintime=$("input[name='indate']").val();//从表单中得到入职时间
        var endtime=$("input[name='leavedate']").val();//从表单中得到用后自己选择的离职时间     
      if(json){
        if(json.indate){
        	var begintime=json.indate;
        }
      }
        $.ajax({
            type:'POST',
            url:"__URL__/lookupgetdate",
            data:{sdate:begintime,edate:endtime},
            cache:false,
            success:function(d){
                $("input[name='workage']").val(d);
            }
        });
    },150);
}
</script>
<div class="page">
	<div class="pageContent">
		<form method="post" action="__URL__/insert/rel/mishrprobationemployee" class="pageForm required-validate" onsubmit="return validateCallback(this,dialogAjaxDone);">
			<input type="hidden" name="dotype" value="流程新建" />
			<input type="hidden"  class="org1.workstatus" name="leavetype"  >
			<input type="hidden" name="isprincipal" value="1" />
			<input type="hidden" name="beforeInsert" value="1" />
			<input type="hidden" name="dutyid"  class="org1.dutylevelid"/>
			<input type="hidden" name="deptid"  class="org1.deptid"/>
			<input type="hidden" name="refreshtabs[closeall]" value="1" />  
			<div class="contentTitle contentTitle_center">代办离职申请单
			<input type="hidden"  class="org1.workstatus" name="leavetype" value="{$MisHrBasicEmployeeList.workstatus}">
			</div>
			<div class="pageFormContent " layoutH="105">
				<FIELDSET>
				<div class="tml-row">
				{:W('ShowOrderno',array(1,'mis_hr_leave_employee'))}
					<div class="tml-form-col">
						<label>姓&nbsp;&nbsp;&nbsp;&nbsp;名：</label>
						<div class="tml-input-append">
						<input type="hidden" name="employeeid" callback="changeworkage" class="org1.mangid tml-input-num" value="{$volist.id}" check_key="id" />
						<input type="text" readonly="readonly" name="name" value="{$volist.name}"   autocomplete="off" class="org1.name checkByInput inputCheckForButton "   >
						<a class="input-addon input-addon-userplus" href="__URL__/lookupmanage/" lookupGroup="org1">查找带回</a>
						</div>
					</div>
					<div class="tml-form-col">
						<label>部&nbsp;&nbsp;&nbsp;&nbsp;门：</label>
						 <input type="text" class="org1.deptname" value="{$volist.deptid|getFieldBy='id','name','mis_system_department'}" readonly="readonly" />
					</div>
					<div class="tml-form-col">
						<label>职&nbsp;&nbsp;&nbsp;&nbsp;位：</label>
						  <input type="text" class="org1.dutyname" value="{$volist.dutylevelid|getFieldBy='id','name','duty'}"  readonly="readonly" />
					</div>
					<div class="tml-form-col">
						<label>岗&nbsp;&nbsp;&nbsp;&nbsp;位：</label>
						   <input type="text" class="org1.worktypename" value="{$volist.worktype|getFieldBy='id','name','mis_hr_job_info'}"  readonly="readonly" />
					</div>
					<div class="tml-form-col">
						<label>联系方式：</label>
						<input type="text" class="textInput org1.phone" readonly="readonly"   check_key="otherphone"  value="{$volist.phone}"  />
					</div>	
					<div class="tml-form-col">
					 	<label>身份证号：</label>
						<input name="chinaid" type="text"  readonly="readonly" value="{$volist.chinaid}" check_key="otherchinaid" class="textInput  org1.chinaid" />
					</div>
					<div class="tml-form-col">
						<label> 入职时间： </label>
						<input type="text"  class="org1.indate" name="indate"  readonly="readonly">
					</div>
					<div class="tml-form-col">
						<label>预离时间 ： </label>
						<div class="tml-input-append">
						<input type="text" onfocus="WdatePicker()"  name="leavedate"  value="{$time|transtime}" size="15" class="Wdate required"  onblur="changeworkage()" name="leavedate"   />
						<span class="input-addon input-addon-calendar"></span>
						</div>
					</div>
						<div class="tml-form-col">
								<label>工&nbsp;&nbsp;&nbsp;&nbsp;龄：</label>
								<input type="text" name='workage'  readonly="readonly">
							</div>
							<div class="tml-form-col">
						<label>离职类型： </label>
						<select  name="forleavetype"  class="combox">
						  <volist name="forLeaveList" id="forLeave">
						  	<option  value="{$key}">{$forLeave}</option>
						  </volist>
						</select>
					</div>
				</div>
				<div class="tml-form-row">
						<label>原因描述</label>
					<TEXTAREA  name="leavereason" class="required"></TEXTAREA>
				</div>
				</fieldset>
				<div class="tml-row">
					<div class="tml-form-col">
						<label>代&nbsp;办&nbsp;人：</label>
						<input type="text" class="textInput" readonly="readonly" value="{$Think.SESSION.loginUserName}" />
					</div>	
					<div class="tml-form-col">
					 	<label>代办时间：</label>
						<input name="applicationdate" type="text" readonly="readonly" value="{$time|transTime}"  class="textInput required" />
					</div>
				</div>
			</div>
			{:W('ShowAction')}
		</form>
	</div>
</div>